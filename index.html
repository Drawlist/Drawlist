<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Drawlist с ластиком, масштабированием и текстом</title>

  <style>
    :root {
      --bg-color: white;
      --text-color: black;
    }

    @media (prefers-color-scheme: dark) {
      :root {
        --bg-color: #121212;
        --text-color: #f1f1f1;
      }
    }

    body {
      background-color: var(--bg-color);
      color: var(--text-color);
      transition: background-color 0.3s, color 0.3s;
      margin: 0;
      padding-top: 60px; /* Отступ для верхней панели */
      height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      font-family: sans-serif;
      user-select: none;
    }

    #topBanner {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 60px;
      background-color: #ccc;
      color: #333;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 24px;
      padding: 0 20px;
      z-index: 1000;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    #themeIcon {
      position: fixed;
      top: 10px;
      right: 10px;
      width: 40px;
      height: 40px;
      pointer-events: none;
      user-select: none;
      z-index: 1100;
    }

    .center-block {
      text-align: center;
    }

    .center-block p {
      font-size: 60px;
      font-weight: 700;
      opacity: 0;
      animation: fadeIn 2s ease-in-out forwards;
      margin-bottom: 20px;
    }

    button {
      padding: 10px 20px;
      font-size: 18px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s ease;
      margin-top: 20px;
      user-select: none;
      opacity: 0;
      animation: fadeIn 1s ease forwards;
    }

    button:hover {
      background-color: #45a049;
    }

    #authorsBtn {
      background-color: #2196F3;
      margin-left: 10px;
    }

    #authorsBtn:hover {
      background-color: #1976D2;
    }

    #drawArea {
      display: none;
      flex-direction: column;
      align-items: center;
      touch-action: none;
    }

    canvas {
      width: 90vw;
      max-width: 800px;
      border: 2px solid #333;
      background: white;
      touch-action: none;
      user-select: none;
      -webkit-user-select: none;
      -webkit-touch-callout: none;
      transform-origin: 0 0;
    }

    label {
      margin-top: 10px;
      user-select: none;
      display: inline-block;
      margin-right: 15px;
    }

    input[type="text"], input[type="number"], select {
      padding: 3px 5px;
      font-size: 16px;
      border-radius: 3px;
      border: 1px solid #ccc;
      vertical-align: middle;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @media (max-width: 600px) {
      canvas {
        max-width: 100%;
      }

      button {
        font-size: 14px;
        padding: 8px 16px;
      }
    }

    /* Стили для кнопки почты */
    .email-button {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 12px 20px;
      background-color: #0078D4;
      color: white;
      text-decoration: none;
      border-radius: 6px;
      font-size: 16px;
      font-weight: 500;
      transition: background-color 0.3s ease, transform 0.2s ease;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      margin-top: 20px;
      cursor: pointer;
      user-select: none;
    }

    .email-button:hover {
      background-color: #005fa3;
      transform: translateY(-1px);
    }

    .email-button svg {
      flex-shrink: 0;
    }
  </style>
</head>
<body>

  <div id="topBanner">Начни рисовать</div>

  <svg id="themeIcon" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg"></svg>

  <div class="center-block" id="intro">
    <p>drawlist</p>
    <button id="drawBtn">рисовать</button>
    <button id="authorsBtn">авторы</button>

    <!-- Кнопка написать на почту -->
    <a href="grandmastertop777@gmail.com" class="email-button">
      <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="white" viewBox="0 0 24 24">
        <path d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 2v.01L12 13 4 6.01V6h16zM4 18V8l8 5 8-5v10H4z"/>
      </svg>
      <span>Написать мне</span>
    </a>
  </div>

  <div id="drawArea" style="display: none; flex-direction: column; align-items: center;">
    <canvas id="canvas"></canvas>
    
    <label>
      Цвет:
      <input type="color" id="colorPicker" value="#000000" style="margin-left: 5px; width: 40px; height: 30px; border: none;">
    </label>

    <label>
      Толщина:
      <select id="lineWidthSelect" style="margin-left: 5px; padding: 5px;">
        <option value="2">Тонкая</option>
        <option value="5" selected>Средняя</option>
        <option value="10">Толстая</option>
      </select>
    </label>

    <label style="margin-top:10px;">
      Текст:
      <input type="text" id="textInput" placeholder="Введите текст" style="margin-left: 5px; width: 150px;">
    </label>

    <label>
      Шрифт:
      <select id="fontSelect" style="margin-left: 5px; padding: 5px;">
        <option value="Arial" selected>Arial</option>
        <option value="Times New Roman">Times New Roman</option>
        <option value="Courier New">Courier New</option>
        <option value="Georgia">Georgia</option>
        <option value="Verdana">Verdana</option>
      </select>
    </label>

    <label>
      Размер:
      <input type="number" id="fontSizeInput" value="24" min="8" max="72" style="width: 60px; margin-left: 5px; padding: 3px;">
    </label>

    <button id="eraserBtn">Ластик</button>
    <button id="clearBtn">Очистить</button>
    <button id="saveBtn">Скачать</button>
    <button id="resetViewBtn" style="background:#2196F3; margin-top:10px;">Сбросить масштаб</button>
  </div>

  <footer style="margin-top: 20px; font-size: 14px;">
    © 2025 Все права защищены
  </footer>

<script>
  const intro = document.getElementById('intro');
  const drawBtn = document.getElementById('drawBtn');
  const authorsBtn = document.getElementById('authorsBtn');
  const drawArea = document.getElementById('drawArea');
  const canvas = document.getElementById('canvas');
  const clearBtn = document.getElementById('clearBtn');
  const eraserBtn = document.getElementById('eraserBtn');
  const saveBtn = document.getElementById('saveBtn');
  const resetViewBtn = document.getElementById('resetViewBtn');
  const colorPicker = document.getElementById('colorPicker');
  const lineWidthSelect = document.getElementById('lineWidthSelect');

  const textInput = document.getElementById('textInput');
  const fontSelect = document.getElementById('fontSelect');
  const fontSizeInput = document.getElementById('fontSizeInput');

  const ctx = canvas.getContext('2d');

  let drawing = false;
  let erasing = false;
  let scale = 1;
  let originX = 0;
  let originY = 0;
  let lastX = 0;
  let lastY = 0;

  let paths = [];

  function resizeCanvas() {
    const rect = canvas.getBoundingClientRect();
    canvas.width = rect.width * window.devicePixelRatio;
    canvas.height = rect.height * window.devicePixelRatio;
    ctx.scale(window.devicePixelRatio, window.devicePixelRatio);
    redraw();
  }

  function redraw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    ctx.save();
    ctx.setTransform(scale, 0, 0, scale, originX, originY);

    paths.forEach(path => {
      ctx.beginPath();
      ctx.strokeStyle = path.color;
      ctx.lineWidth = path.lineWidth;
      ctx.lineCap = 'round';
      ctx.lineJoin = 'round';
      for (let i = 0; i < path.points.length; i++) {
        const p = path.points[i];
        if (i === 0) ctx.moveTo(p.x, p.y);
        else ctx.lineTo(p.x, p.y);
      }
      ctx.stroke();
    });

    ctx.restore();
  }

  drawBtn.onclick = () => {
    intro.style.display = 'none';
    drawArea.style.display = 'flex';
    resizeCanvas();
  };

  window.addEventListener('resize', resizeCanvas);

  canvas.addEventListener('mousedown', e => {
    drawing = true;
    lastX = (e.offsetX - originX) / scale;
    lastY = (e.offsetY - originY) / scale;
    paths.push({
      color: erasing ? '#FFFFFF' : colorPicker.value,
      lineWidth: parseInt(lineWidthSelect.value),
      points: [{ x: lastX, y: lastY }]
    });
  });

  canvas.addEventListener('mousemove', e => {
    if (!drawing) return;
    const x = (e.offsetX - originX) / scale;
    const y = (e.offsetY - originY) / scale;
    const currentPath = paths[paths.length - 1];
    currentPath.points.push({ x, y });
    lastX = x;
    lastY = y;
    redraw();
  });

  canvas.addEventListener('mouseup', () => {
    drawing = false;
  });

  canvas.addEventListener('mouseleave', () => {
    drawing = false;
  });

  eraserBtn.onclick = () => {
    erasing = !erasing;
    eraserBtn.textContent = erasing ? 'Рисовать' : 'Ластик';
  };

  clearBtn.onclick = () => {
    paths = [];
    redraw();
  };

  saveBtn.onclick = () => {
    const dataUrl = canvas.toDataURL('image/png');
    const link = document.createElement('a');
    link.href = dataUrl;
    link.download = 'drawlist.png';
    link.click();
  };

  // Масштабирование колесиком мыши
  canvas.addEventListener('wheel', e => {
    e.preventDefault();
    const delta = e.deltaY < 0 ? 1.1 : 0.9;
    const mouseX = e.offsetX;
    const mouseY = e.offsetY;

    originX = mouseX - (mouseX - originX) * delta;
    originY = mouseY - (mouseY - originY) * delta;
    scale *= delta;

    if (scale < 0.5) scale = 0.5;
    if (scale > 4) scale = 4;

    redraw();
  });

  resetViewBtn.onclick = () => {
    scale = 1;
    originX = 0;
    originY = 0;
    redraw();
  };

  // Добавление текста по клику
  canvas.addEventListener('click', e => {
    if (!textInput.value.trim()) return;

    const x = (e.offsetX - originX) / scale;
    const y = (e.offsetY - originY) / scale;

    ctx.save();
    ctx.setTransform(scale, 0, 0, scale, originX, originY);
    ctx.fillStyle = colorPicker.value;
    ctx.font = `${fontSizeInput.value}px ${fontSelect.value}`;
    ctx.fillText(textInput.value, x, y);
    ctx.restore();
  });

  // Показ иконки темы в левом верхнем углу
  const themeIcon = document.getElementById('themeIcon');
  function updateThemeIcon() {
    const isDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
    themeIcon.innerHTML = isDark
      ? `<circle cx="32" cy="32" r="20" fill="yellow"/>` // Простая иконка солнца в темном режиме
      : `<circle cx="32" cy="32" r="20" fill="black"/>`; // Иконка луны в светлом режиме
  }
  updateThemeIcon();
  window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', updateThemeIcon);
</script>

</body>
</html>
